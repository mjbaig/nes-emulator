class t extends HTMLElement{width=256;height=240;offset=0;constructor(){super(),this.value="",this.canvas=document.createElement("canvas"),this.canvas.id="nes-window",this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style="border:1px solid #000000;",this.context=this.canvas.getContext("2d"),this.imageData=this.context.createImageData(this.width,this.height),window.addEventListener("cpu-tick",(t=>{this.drawFrame(this.offset),this.offset+=1}))}static get observedAttributes(){return["test"]}drawFrame(t){for(var s=0;s<this.width;s++)for(var e=0;e<this.height;e++){var a=4*(e*this.width+s),n=(s+t)%256^(e+t)%256,i=(2*s+t)%256^(2*e+t)%256,c=50+Math.floor(100*Math.random());c=(c+t)%256,this.imageData.data[a]=n,this.imageData.data[a+1]=i,this.imageData.data[a+2]=c,this.imageData.data[a+3]=255}this.context.putImageData(this.imageData,0,0)}attributeChangedCallback(t,s,e){console.log("change detected"),"test"===t&&(this.drawFrame(this.offset),this.offset+=2)}connectedCallback(){console.log("connected"),this.appendChild(this.canvas)}}customElements.define("nes-window",t);const s=new class{constructor(){this.channels=new Map}registerChannel(t){this.channels.get(t)||this.channels.set(t,{name:t,subscriberCallbacks:[]})}destroyChannel(t){void 0!==this.channels.get(t)&&this.channels.delete(t)}send(t){const s=t.channelName;if(s){const e=this.channels.get(s);if(void 0!==e){e.subscriberCallbacks.map((s=>{s(t)}))}}}registerSubscriber(t,s){const e=this.channels.get(t);void 0!==e&&e.subscriberCallbacks.push(s)}};(new class{constructor(t){this.nesWindow=t,this.tickEvent=new CustomEvent("cpu-tick",{detail:{image_details:[{}]}})}run(){setInterval((()=>{this.tickEvent.detail.image_details=[{}],window.dispatchEvent(this.tickEvent)}),5)}}).run(),new class{constructor(t){}run(){}}(s).run(),new class{constructor(t){}run(){}}(s).run(),new class{constructor(t){}run(){}}(s).run(),new class{constructor(t){}run(){}}(s).run();const e={NESWindow:t};export{e as NESEmulator};
